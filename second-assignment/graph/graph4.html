<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Eco-Benefit Project</title>
    <link rel="stylesheet" type="text/css" href="/vendor/css/robotoSlab.css">
    <link rel="stylesheet" type="text/css" href="/vendor/css/firaSans.css">
    <link rel="stylesheet" type="text/css" href="/css/ecoBenefit.css">
    <link rel="stylesheet" type="text/css" href="/second-assignment/css/graph4.css">
    <script src="https://d3js.org/d3.v6.js"></script>
    <script type="text/javascript" src="/vendor/js/jquery.min.js"></script>
    <script type="text/javascript" src="/js/ecoBenefit.js"></script>
</head>

<body>
    <header class="text-center my-3">
        <h1 class="button mb-0">GRAPH IV - 6 SCATTERPLOT (sbagliato)</h1>
    </header>
    <section class="text-center single-container mb-3">
        <div id="my_dataviz"></div>
    </section>
    
<script>

    // set the dimensions and margins of the graph
    const margin = {top: 30, right: 0, bottom: 30, left: 50},
        width = 510 - margin.left - margin.right,
        height = 510 - margin.top - margin.bottom;
    
    //Read the data
    d3.csv("../csv/graph4.csv").then( function(data) {
    
      // group the data: I want to draw one line per group
      const sumstat = d3.group(data, d => d.Name) // nest function allows to group the calculation per level of a factor
        console.log(sumstat)
      // What is the list of groups?
      const allKeys = data.map(d => d.Name);
      //console.log(allKeys);
    
      // Add an svg element for each group. The will be one beside each other and will go on the next row when no more room available
      const svg = d3.select("#my_dataviz")
        .selectAll("uniqueChart")
        .data(sumstat)
        .join("svg")
          .attr("width", width + margin.left + margin.right)
          .attr("height", height + margin.top + margin.bottom)
        .append("g")
          .attr("transform",
                `translate(${margin.left},${margin.top})`);
    
      // Add X axis --> it is a date format
      const x = d3.scaleLinear()
        x.domain([0, 60])
        //.domain(d3.extent(data, function(d) { return d.Height; }))
        .range([ 0, width ]);
      svg
        .append("g")
        .attr("transform", `translate(0, ${height})`)
        .call(d3.axisBottom(x).ticks(6));
    
      //Add Y axis
      const y = d3.scaleLinear()
      .domain([0, 8000])
        //.domain([0, d3.max(data, function(d) { return +d.Carbon; })])
        .range([ height, 0 ]);
      svg.append("g")
        .call(d3.axisLeft(y).ticks(10));
    
      // color palette
      //const color = d3.scaleOrdinal().domain(data)
    //.range(d3.schemeSet3);

      const color = d3.scaleOrdinal()
        .domain(allKeys)
        .range(['#e41a1c','#377eb8','#4daf4a','#984ea3','#ff7f00','#964b00'])
    
      // Draw the dots

      svg
        .append("g")
        .selectAll("dot")
        .data(data)
        .join("circle")
        .attr("cx", function (d) { return x( d.Height); } )
        .attr("cy", function (d) { return y(d.Carbon); } )
        
        .attr("r", 2)
        //(d[1])
        .style("fill", function (d) { return color(d.Name) } )
           
          
    
      // Add titles
      svg
        .append("text")
        .attr("text-anchor", "start")
        .attr("y", -5)
        .attr("x", 0)
        .text(function(d){ return(d[0])})
        .style("fill", function(d){ return color(d[0]) })
    
    })
    </script>
</body>

</html>
